<html>
<head>
    <script>
        // Case 1: 建立簡單的通知
        var notifyConfig = {
        body: "\\ ^o^ /",
        icon: "https://cythilya.github.io/public/favicon.ico"
        }

        function createNotify() {
        if (!("Notification" in window)) { // 檢查瀏覽器是否支援通知
            console.log("This browser does not support notification");
        } else if (Notification.permission === "granted") { // 使用者已同意通知
            var notification = new Notification(
            "Thanks for granting this permission.", notifyConfig
            );
        } else if (Notification.permission !== "denied") {
            // 通知權限為 default (未要求) or undefined (老舊瀏覽器的未知狀態)，向使用者要求權限
            Notification.requestPermission(function(permission) {
            if (permission === "granted") {
                var notification = new Notification("Hi there!", notifyConfig);
            }
            });
        }
        }

        // Case 2: 加上標籤
        function notifyMe() {
        var tagList = ['newArrival', 'newFeature', 'newMsg', 'promotion'];
        var len = tagList.length;
        var times = 0;
        var timerNewArrival = setInterval(function() {
            sendNotify({
            title: tagList[times % len] + ' ' + times,
            body: '\\ ^o^ /',
            tag: tagList[times % len],
            icon: "https://cythilya.github.io/public/favicon.ico",
            url: 'http://www.ruten.com.tw/'
            });
            if (times++ == 20) {
            clearInterval(timerNewArrival);
            }
        }, 1000);
        }

        function sendNotify(msg) {
        var notify = new Notification(msg.title , {
            icon: msg.icon,
            body: msg.body,
            tag: msg.tag,
        });

        if(msg.url) {
            notify.onclick = function(e) { // Case 3: 綁定 click 事件
            e.preventDefault();
            window.open(msg.url);
            }
        }
        }
    </script>
</head>
<body>
    <button onclick="createNotify()">Create Notify!</button>
    <button onclick="notifyMe()">Notify me!</button>
</body>
</html>